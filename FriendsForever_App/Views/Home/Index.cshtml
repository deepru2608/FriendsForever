@model UserDashboardViewModel
@{
    ViewData["Title"] = "Index";
}

@*<meta http-equiv="refresh" content="10">*@

<!-- Page Container -->
<div class="w3-container w3-content" style="max-width:1400px;margin-top:80px">
    <!-- The Grid -->
    <div class="w3-row">
        <!-- Left Column -->
        <div class="w3-col m3 mt-2" style="display: inline-block">
            <!-- Profile -->
            <div class="w3-card w3-round w3-white">
                <div class="w3-container">
                    <h4 class="w3-center mt-1 text-primary" style="padding-top: 5px;">@Model.Name</h4>
                    <p class="w3-center">
                        @{
                            var profilePhotoPath = (Model.ProfilePhotoPath ?? "Microsoft_Default.png");
                        }
                        <img src="~/Images/ProfileImage/@profilePhotoPath" class="w3-circle" style="height:106px;width:106px" alt="Deepanshu">
                    </p>
                    <p class="w3-center">
                        <a asp-action="ViewProfile" asp-controller="Home" class="btn btn-sm btn-primary" style="color: white; list-style: none">View Profile</a>
                    </p>
                    <hr>
                    <p><i class="fas fa-envelope-open-text fa-fw w3-margin-right w3-text-theme"></i> @Model.Email</p>
                    <p><i class="fa fa-home fa-fw w3-margin-right w3-text-theme"></i> @Model.Country</p>
                    <p><i class="fa fa-birthday-cake fa-fw w3-margin-right w3-text-theme"></i> @Model.Dob.ToLongDateString()</p>
                </div>
            </div>
            <br>

            <!-- Interests -->
            <div class="w3-card w3-round w3-white w3-hide-small">
                <div class="w3-container">
                    <p>Interests</p>
                    <p>
                        @if (Model.UserInterests.Any())
                        {
                            @foreach (var userInterest in Model.UserInterests)
                            {
                                <span class="w3-tag w3-small w3-theme">@userInterest</span>
                            }
                        }
                        else
                        {
                            <span class="w3-tag w3-small w3-theme">No interest added.</span>
                        }
                    </p>
                </div>
            </div>

            <!-- End Left Column -->
        </div>

        <!-- Middle Column -->
        <div class="w3-col m7">
            <form method="post">
                <div class="w3-row-padding">
                    <div class="w3-col m12">
                        <div class="w3-card w3-round w3-white">
                            <div class="w3-container w3-padding">
                                <input type="text" asp-for="YourStory" class="w3-border form-control w3-padding"
                                       value="Hi @Model.Name, Write your thought..." autocomplete="off" />
                                <button class="w3-button w3-theme mt-2" asp-action="NewStory" asp-controller="Home">
                                    <i class="fas fa-external-link-square-alt"></i>&nbsp;<span style="font-size: 15px">Add Post</span>
                                </button>
                                <a asp-action="NewPost" asp-controller="Home" class="w3-button w3-theme navbar-brand mt-2">
                                    <i class="fas fa-external-link-square-alt"></i>&nbsp;<span style="font-size: 15px">Create New Post</span>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </form>

            @if (Model.AllPosts.Any())
            {
                @foreach (var post in Model.AllPosts)
                {
                    var postedOwnerPhoto = (post.PostedOwnerPhoto ?? "Microsoft_Default.png");
                    if (post.PhotoAttached == "Attached")
                    {
                        var postImageCount = Model.PostPhotoCount.FirstOrDefault(f => f.PostedId == post.PostedId);
                        IEnumerable<PostImages> allPhotos = Model.AllPhotos.Where(w => w.PostedId == post.PostedId);
                        if (postImageCount.PostPhotoCount > 1)
                        {
                            <div class="w3-container w3-card w3-white w3-round w3-margin">
                                <br>
                                <img src="~/Images/ProfileImage/@postedOwnerPhoto" alt="Avatar" class="w3-left w3-circle w3-margin-right" style="width:50px; height: 50px;">
                                <span class="w3-right w3-opacity">@((DateTime.Now - post.PostedTimeStamp).Minutes) mins</span>
                                <h4>@post.PostedOwnerName</h4><br>
                                <hr class="w3-clear">
                                <p>@post.PostedContent</p>
                                <div class="w3-row-padding" style="margin:0 -16px">
                                    @foreach (var images in allPhotos)
                                    {
                                        var photoPath = (images.PostedPhoto ?? "Microsoft_Default.png");
                                        <div class="w3-half">
                                            <img src="~/Images/PostImages/@photoPath" style="width:100%" alt="Northern Lights" class="w3-margin-bottom">
                                        </div>
                                    }
                                </div>
                                <hr class="w3-clear">
                                <div class="p-2">
                                    <span class="mr-auto"><i class="far fa-thumbs-up"></i> @post.LikesCount</span>
                                    <span class="ml-auto"><i class="far fa-comment-alt"></i> @post.CommentsCount</span>
                                </div>
                                <hr class="w3-clear">
                                <button type="button" class="w3-button w3-theme-d1 w3-margin-bottom"><i class="fa fa-thumbs-up"></i>  Like</button>
                                <button type="button" class="w3-button w3-theme-d2 w3-margin-bottom"><i class="fa fa-comment"></i>  Comment</button>
                            </div>
                        }
                        else
                        {
                            <div class="w3-container w3-card w3-white w3-round w3-margin">
                                <br>
                                <img src="~/Images/ProfileImage/@postedOwnerPhoto" alt="Avatar" class="w3-left w3-circle w3-margin-right" style="width:50px; height: 50px;">
                                <span class="w3-right w3-opacity">@((DateTime.Now - post.PostedTimeStamp).Minutes) mins</span>
                                <h4>@post.PostedOwnerName</h4><br>
                                <hr class="w3-clear">
                                <p>@post.PostedContent</p>
                                <div class="w3-row-padding" style="margin:0 -16px">
                                    @foreach (var images in allPhotos)
                                    {
                                        var photoPath = (images.PostedPhoto ?? "Microsoft_Default.png");
                                        <img src="~/Images/PostImages/@photoPath" style="width:100%" class="w3-margin-bottom">
                                    }
                                </div>
                                <hr class="w3-clear">
                                <div class="p-2">
                                    <span class="mr-auto"><i class="far fa-thumbs-up"></i> @post.LikesCount</span>
                                    <span class="ml-auto"><i class="far fa-comment-alt"></i> @post.CommentsCount</span>
                                </div>
                                <hr class="w3-clear">
                                <button type="button" class="w3-button w3-theme-d1 w3-margin-bottom"><i class="fa fa-thumbs-up"></i>  Like</button>
                                <button type="button" class="w3-button w3-theme-d2 w3-margin-bottom"><i class="fa fa-comment"></i>  Comment</button>
                            </div>
                        }
                    }
                    else
                    {
                        <div class="w3-container w3-card w3-white w3-round w3-margin">
                            <br>
                            <img src="~/Images/ProfileImage/@postedOwnerPhoto" alt="Avatar" class="w3-left w3-circle w3-margin-right" style="width:50px; height: 50px;">
                            <span class="w3-right w3-opacity">@((DateTime.Now - post.PostedTimeStamp).Minutes) mins</span>
                            <h4>@post.PostedOwnerName</h4><br>
                            <hr class="w3-clear">
                            <p>@post.PostedContent</p>
                            <hr class="w3-clear">
                            <div class="p-2">
                                <span class="mr-auto"><i class="far fa-thumbs-up"></i> @post.LikesCount</span>
                                <span class="ml-auto"><i class="far fa-comment-alt"></i> @post.CommentsCount</span>
                            </div>
                            <hr class="w3-clear">
                            <button type="button" class="w3-button w3-theme-d1 w3-margin-bottom"><i class="fa fa-thumbs-up"></i>  Like</button>
                            <button type="button" class="w3-button w3-theme-d2 w3-margin-bottom"><i class="fa fa-comment"></i>  Comment</button>
                        </div>
                    }
                }
            }
            else
            {
                <div class="w3-container w3-card w3-white w3-round w3-margin text-center">
                    <label class="text-info">No post available.</label>
                </div>
            }

            <!-- End Middle Column -->
        </div>

        <!-- Right Column -->
        <div class="w3-col m2" style="display: inline-block">
            <div class="w3-card w3-round w3-white w3-center">
                <div class="w3-container">
                    <p style="padding-top: 5px" class="text-primary">Friend Request</p>
                    <img src="~/Images/ProfileImage/@profilePhotoPath" class="w3-circle" alt="Avatar" style="height:106px;width:106px"><br>
                    <span class="text-info">Jane Doe</span>
                    <div class="w3-row w3-opacity">
                        <div class="w3-half">
                            <button class="w3-button w3-block w3-green w3-section" title="Accept">Accept</button>
                        </div>
                        <div class="w3-half">
                            <button class="w3-button w3-block w3-red w3-section" title="Decline">Reject</button>
                        </div>
                    </div>
                </div>
            </div>
            <br>

            <div class="w3-card w3-round w3-white w3-padding-16 w3-center">
                <p>ADS</p>
            </div>

            <!-- End Right Column -->
        </div>
    </div>
</div>

@section Scripts{

}